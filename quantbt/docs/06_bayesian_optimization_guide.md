# νν† λ¦¬μ–Ό 6: λ² μ΄μ§€μ• νλΌλ―Έν„° μµμ ν™”

μ΄μ „ νν† λ¦¬μ–Όμ κ·Έλ¦¬λ“ μ„μΉλ” λ¨λ“  νλΌλ―Έν„° μ΅°ν•©μ„ λ¬΄μ‘μ„λ΅ ν…μ¤νΈν•κΈ° λ•λ¬Έμ— λΉ„ν¨μ¨μ μΌ μ μμµλ‹λ‹¤. 'λ² μ΄μ§€μ• μµμ ν™”(Bayesian Optimization)'λ” λ” μ μ€ μ‹λ„λ΅ λ” λ‚μ€ νλΌλ―Έν„°λ¥Ό μ°ΎκΈ° μ„ν• μ§€λ¥μ μΈ νƒμƒ‰ λ°©λ²•μ…λ‹λ‹¤. μ΄μ „ ν…μ¤νΈ κ²°κ³Όλ¥Ό λ°”νƒ•μΌλ΅ λ‹¤μ ν…μ¤νΈν•  νλΌλ―Έν„°λ¥Ό ν™•λ¥ μ μΌλ΅ μμΈ΅ν•μ—¬ κ°€μ¥ μ„±λ¥μ΄ μΆ‹μ„ κ²ƒμΌλ΅ κΈ°λ€λλ” μμ—­μ„ μ§‘μ¤‘μ μΌλ΅ νƒμƒ‰ν•©λ‹λ‹¤.

> μ „μ²΄ μ½”λ“λ” μ•„λ Jupyter Notebook λ§ν¬μ—μ„ ν™•μΈν•κ³  μ§μ ‘ μ‹¤ν–‰ν•΄λ³Ό μ μμµλ‹λ‹¤.
>
> π‘‰ **[μμ  λ…ΈνΈλ¶ λ°”λ΅κ°€κΈ°: 06_bayesian_optimization.ipynb](../examples/06_bayesian_optimization.ipynb)**

## 1. λ² μ΄μ§€μ• μµμ ν™”μ κ°λ…

λ² μ΄μ§€μ• μµμ ν™”λ” 'λ©ν‘ ν•¨μ(Objective Function)'μ κ°’μ„ μµλ€ν™”ν•λ” νλΌλ―Έν„°λ¥Ό μ°Ύλ” κ²ƒμ„ λ©ν‘λ΅ ν•©λ‹λ‹¤.
1.  **μ΄κΈ° μƒν”λ§**: νλΌλ―Έν„° κ³µκ°„μ—μ„ λ‡ κ°μ ν¬μΈνΈλ¥Ό λ¬΄μ‘μ„λ΅ μ„ νƒν•μ—¬ λ©ν‘ ν•¨μ(λ°±ν…μ¤ν…)λ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤.
2.  **ν™•λ¥  λ¨λΈλ§**: ν„μ¬κΉμ§€μ (νλΌλ―Έν„°, μ„±λ¥) λ°μ΄ν„°λ¥Ό λ°”νƒ•μΌλ΅ μ•„μ§ νƒμƒ‰ν•μ§€ μ•μ€ κ³µκ°„μ μ„±λ¥μ„ μμΈ΅ν•λ” ν™•λ¥  λ¨λΈ(λ³΄ν†µ κ°€μ°μ‹μ• ν”„λ΅μ„Έμ¤)μ„ λ§λ“­λ‹λ‹¤.
3.  **νλ“ ν•¨μ (Acquisition Function)**: ν™•λ¥  λ¨λΈμ„ μ‚¬μ©ν•μ—¬ 'λ‹¤μ μ‹λ„μ—μ„ ν„μ¬ μµκ³  μ„±λ¥μ„ λ„μ–΄μ„¤ ν™•λ¥ 'μ΄ κ°€μ¥ λ†’μ€ νλΌλ―Έν„°λ¥Ό κ³„μ‚°ν•©λ‹λ‹¤.
4.  **λ°λ³µ**: 3μ—μ„ μ°Ύμ€ νλΌλ―Έν„°λ΅ μ‹¤μ  λ°±ν…μ¤ν…μ„ μν–‰ν•κ³ , κ²°κ³Όλ¥Ό 2μ λ°μ΄ν„°μ— μ¶”κ°€ν•μ—¬ λ¨λΈμ„ μ—…λ°μ΄νΈν•©λ‹λ‹¤. μ΄ κ³Όμ •μ„ μ •ν•΄μ§„ νμλ§νΌ λ°λ³µν•©λ‹λ‹¤.

μ΄ λ°©μ‹μ„ ν†µν•΄ λ¬΄μλ―Έν• νλΌλ―Έν„° μ΅°ν•©μ— λ€ν• ν…μ¤νΈλ¥Ό μ¤„μ΄κ³ , κ°€λ¥μ„± λ†’μ€ μμ—­μ— μ§‘μ¤‘ν•μ—¬ ν¨μ¨μ μΌλ΅ μµμ ν•΄λ¥Ό μ°Ύμ•„κ°‘λ‹λ‹¤.

## 2. λ² μ΄μ§€μ• μµμ ν™” κ³Όμ •

QuantBTλ” `BayesianParameterOptimizer` ν΄λμ¤λ¥Ό ν†µν•΄ λ² μ΄μ§€μ• μµμ ν™” κΈ°λ¥μ„ μ κ³µν•©λ‹λ‹¤.

### λ‹¨κ³„ 1: λ©ν‘ ν•¨μ μ •μ

μµμ ν™”μ λ€μƒμ΄ λλ” λ©ν‘ ν•¨μλ¥Ό μ •μν•©λ‹λ‹¤. μ΄ ν•¨μλ” νλΌλ―Έν„°λ¥Ό μΈμλ΅ λ°›μ•„ λ°±ν…μ¤ν…μ„ μν–‰ν•κ³ , μµλ€ν™”ν•λ ¤λ” κ°’(μ: `sharpe_ratio`)μ„ λ°ν™ν•΄μ•Ό ν•©λ‹λ‹¤. **μ£Όμ: λ² μ΄μ§€μ• μµμ ν™” λΌμ΄λΈλ¬λ¦¬λ” λ³΄ν†µ μµμ†κ°’μ„ μ°Ύλ„λ΅ μ„¤κ³„λμ–΄ μμΌλ―€λ΅, μµλ€ν™”λ¥Ό μ„ν•΄ μμµλ¥ μ΄λ‚ μƒ¤ν”„ μ§€μμ— -1μ„ κ³±ν•μ—¬ λ°ν™ν•λ” κ²ƒμ΄ μΌλ°μ μ…λ‹λ‹¤.**

```python
def objective_function(fast_sma, slow_sma):
    """λ² μ΄μ§€μ• μµμ ν™”λ¥Ό μ„ν• λ©ν‘ ν•¨μ"""
    # νλΌλ―Έν„° μ ν¨μ„± κ²€μ‚¬
    if fast_sma >= slow_sma:
        return -1e9 # λ¬΄ν¨ν• μ΅°ν•©μ— λ€ν•΄ λ§¤μ° λ‚®μ€ κ°’ λ°ν™
        
    result = qbt.backtest(...) # λ°±ν…μ¤ν… μ‹¤ν–‰
    
    # μƒ¤ν”„ μ§€μλ¥Ό μµλ€ν™”ν•λ” κ²ƒμ΄ λ©ν‘
    return result.sharpe_ratio
```

### λ‹¨κ³„ 2: νλΌλ―Έν„° νƒμƒ‰ κ³µκ°„ μ •μ

μµμ ν™”ν•  κ° νλΌλ―Έν„°μ νƒμƒ‰ λ²”μ„λ¥Ό μ •μν•©λ‹λ‹¤.

```python
param_space = {
    'fast_sma': (10, 50),     # 10μ—μ„ 50 μ‚¬μ΄μ μ •μ
    'slow_sma': (50, 200)     # 50μ—μ„ 200 μ‚¬μ΄μ μ •μ
}
```

### λ‹¨κ³„ 3: μµμ ν™” μ‹¤ν–‰

`BayesianParameterOptimizer`λ¥Ό μ‚¬μ©ν•μ—¬ μµμ ν™”λ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤.

```python
from quantbt.ray import BayesianParameterOptimizer

# μµμ ν™”κΈ° μƒμ„±
optimizer = BayesianParameterOptimizer(
    objective_function,
    param_space
)

# μµμ ν™” μ‹¤ν–‰ (μ΄κΈ° 5ν λλ¤ νƒμƒ‰, 25ν μµμ ν™” μ‹λ„)
best_params, all_results = optimizer.run_optimization(
    init_points=5, 
    n_iter=25
)
```

## 3. κ²°κ³Ό λ¶„μ„

μµμ ν™”κ°€ μ™„λ£λλ©΄ κ°€μ¥ μΆ‹μ€ μ„±λ¥μ„ λ³΄μΈ νλΌλ―Έν„°μ™€ μ „μ²΄ νƒμƒ‰ κ³Όμ •μ„ ν™•μΈν•  μ μμµλ‹λ‹¤.

```python
print("=== Best Parameters Found ===")
print(f"Fast SMA: {best_params['fast_sma']}")
print(f"Slow SMA: {best_params['slow_sma']}")

# μ „μ²΄ κ²°κ³Ό λ°μ΄ν„°ν”„λ μ„μΌλ΅ λ³΄κΈ°
print(all_results.df)
```

λ² μ΄μ§€μ• μµμ ν™”λ” κ·Έλ¦¬λ“ μ„μΉμ— λΉ„ν•΄ ν›¨μ”¬ μ μ€ λ°λ³µμΌλ΅λ„ μ°μν• νλΌλ―Έν„°λ¥Ό μ°Ύμ•„λ‚Ό μ μμ–΄, λ³µμ΅ν• μ „λµμ μµμ ν™” μ‹κ°„μ„ ν¬κ² λ‹¨μ¶•μ‹μΌ μ¤λ‹λ‹¤. 