# νν† λ¦¬μ–Ό 5: νλΌλ―Έν„° λ³‘λ ¬ νƒμƒ‰ (Grid Search)

μ „λµμ μ„±κ³Όλ” νλΌλ―Έν„°(μ: μ΄λ™ν‰κ·  κΈ°κ°„, RSI κ°’ λ“±)μ— λ”°λΌ ν¬κ² λ‹¬λΌμ§‘λ‹λ‹¤. μµμ μ νλΌλ―Έν„° μ΅°ν•©μ„ μ°ΎκΈ° μ„ν•΄ λ‹¤μ–‘ν• κ°’λ“¤μ„ ν…μ¤νΈν•λ” κ³Όμ •μ„ 'νλΌλ―Έν„° μµμ ν™”'λΌκ³  ν•©λ‹λ‹¤. μ΄ νν† λ¦¬μ–Όμ—μ„λ” μ—¬λ¬ νλΌλ―Έν„° μ΅°ν•©μ„ λ³‘λ ¬λ΅ λ™μ‹μ— ν…μ¤νΈν•μ—¬ μµμ ν™” μ‹κ°„μ„ λ‹¨μ¶•ν•λ” λ°©λ²•μ„ μ†κ°ν•©λ‹λ‹¤.

> μ „μ²΄ μ½”λ“λ” μ•„λ Jupyter Notebook λ§ν¬μ—μ„ ν™•μΈν•κ³  μ§μ ‘ μ‹¤ν–‰ν•΄λ³Ό μ μμµλ‹λ‹¤.
>
> π‘‰ **[μμ  λ…ΈνΈλ¶ λ°”λ΅κ°€κΈ°: 05_parallel_search.ipynb](../examples/05_parallel_search.ipynb)**

## 1. νλΌλ―Έν„° μµμ ν™”μ™€ λ³‘λ ¬ μ²λ¦¬

**κ·Έλ¦¬λ“ μ„μΉ(Grid Search)**λ” νλΌλ―Έν„°λ§λ‹¤ ν…μ¤νΈν•  κ°’μ λ²”μ„λ¥Ό μ •ν•κ³ , κ°€λ¥ν• λ¨λ“  μ΅°ν•©μ„ ν•λ‚μ”© ν…μ¤νΈν•μ—¬ κ°€μ¥ μΆ‹μ€ μ„±κ³Όλ¥Ό λ‚΄λ” μ΅°ν•©μ„ μ°Ύλ” κ°€μ¥ κΈ°λ³Έμ μΈ μµμ ν™” λ°©λ²•μ…λ‹λ‹¤. ν•μ§€λ§ μ΅°ν•©μ μκ°€ λ§μ•„μ§€λ©΄ ν…μ¤νΈμ— μ—„μ²­λ‚ μ‹κ°„μ΄ μ†μ”λ  μ μμµλ‹λ‹¤.

QuantBTλ” **Ray** λΌμ΄λΈλ¬λ¦¬μ™€μ ν†µν•©μ„ ν†µν•΄ μ΄ κ³Όμ •μ„ μ—¬λ¬ CPU μ½”μ–΄μ— λ¶„μ‚°μ‹μΌ λ™μ‹μ— μ‹¤ν–‰(λ³‘λ ¬ μ²λ¦¬)ν•¨μΌλ΅μ¨ μµμ ν™” μ‹κ°„μ„ νκΈ°μ μΌλ΅ μ¤„μ—¬μ¤λ‹λ‹¤.

## 2. λ³‘λ ¬ νƒμƒ‰ κ³Όμ •

### λ‹¨κ³„ 1: μµμ ν™”ν•  ν•¨μ μ •μ

λ¨Όμ €, λ‹¨μΌ νλΌλ―Έν„° μ΅°ν•©μ— λ€ν• λ°±ν…μ¤ν…μ„ μν–‰ν•κ³  μ›ν•λ” ν‰κ°€ μ§€ν‘(μ: μ΄μμµλ¥ , μƒ¤ν”„ μ§€μ)λ¥Ό λ°ν™ν•λ” ν•¨μλ¥Ό μ •μν•©λ‹λ‹¤. μ΄ ν•¨μλ” λ³‘λ ¬λ΅ μ‹¤ν–‰λ  μ‘μ—… λ‹¨μ„κ°€ λ©λ‹λ‹¤.

```python
import quantbt as qbt
from quantbt.strategies import SMAStrategy

def run_sma_backtest(params):
    """λ‹¨μΌ SMA μ „λµ λ°±ν…μ¤νΈ μ‹¤ν–‰ ν•¨μ"""
    fast_sma, slow_sma = params
    
    # μ „λµ μƒμ„± λ° λ°±ν…μ¤νΈ μ‹¤ν–‰
    strategy = SMAStrategy(fast_sma=fast_sma, slow_sma=slow_sma)
    result = qbt.backtest(
        strategy=strategy,
        # ... other backtest settings ...
    )
    
    # μµμ ν™” λ©ν‘ μ§€ν‘ λ°ν™
    return {
        "params": params,
        "sharpe_ratio": result.sharpe_ratio,
        "total_return": result.total_return
    }
```

### λ‹¨κ³„ 2: νλΌλ―Έν„° μ΅°ν•© μƒμ„±

ν…μ¤νΈν•  νλΌλ―Έν„°λ“¤μ λ²”μ„λ¥Ό μ§€μ •ν•μ—¬ λ¨λ“  μ΅°ν•©μ λ¦¬μ¤νΈλ¥Ό μƒμ„±ν•©λ‹λ‹¤.

```python
import numpy as np

# λ‹¨κΈ° μ΄ν‰μ„ : 5λ¶€ν„° 20κΉμ§€ 5μ”© μ¦κ°€
fast_sma_range = np.arange(5, 25, 5) 
# μ¥κΈ° μ΄ν‰μ„ : 30λ¶€ν„° 60κΉμ§€ 10μ”© μ¦κ°€
slow_sma_range = np.arange(30, 70, 10) 

# λ¨λ“  νλΌλ―Έν„° μ΅°ν•© μƒμ„±
param_combinations = [
    (fast, slow) 
    for fast in fast_sma_range 
    for slow in slow_sma_range 
    if fast < slow
]
# μ: [(5, 30), (5, 40), ..., (20, 60)]
```

### λ‹¨κ³„ 3: λ³‘λ ¬ μµμ ν™” μ‹¤ν–‰

`qbt.parallel_test` ν•¨μλ¥Ό μ‚¬μ©ν•μ—¬ μƒμ„±λ νλΌλ―Έν„° μ΅°ν•©λ“¤μ„ λ³‘λ ¬λ΅ ν…μ¤νΈν•©λ‹λ‹¤. Rayκ°€ μλ™μΌλ΅ μ‘μ—…μ„ λ¶„μ‚°μ‹μΌ μ²λ¦¬ν•©λ‹λ‹¤.

```python
# λ³‘λ ¬ ν…μ¤νΈ μ‹¤ν–‰
all_results = qbt.parallel_test(
    run_sma_backtest,
    param_combinations
)

# κ²°κ³Ό μ¶λ ¥
for res in all_results:
    print(f"Params: {res['params']}, Sharpe Ratio: {res['sharpe_ratio']:.2f}")
```

## 3. μµμ  νλΌλ―Έν„° λ¶„μ„

λ¨λ“  ν…μ¤νΈκ°€ μ™„λ£λλ©΄, μμ§‘λ κ²°κ³Ό `all_results`λ¥Ό λ¶„μ„ν•μ—¬ κ°€μ¥ λ†’μ€ μ„±κ³Όλ¥Ό λ³΄μΈ νλΌλ―Έν„° μ΅°ν•©μ„ μ°Ύμµλ‹λ‹¤.

```python
# μƒ¤ν”„ μ§€μκ°€ κ°€μ¥ λ†’μ€ κ²°κ³Ό μ°ΎκΈ°
best_result = max(all_results, key=lambda x: x['sharpe_ratio'])

print("\n=== Best Parameters Found ===")
print(f"Best Params: {best_result['params']}")
print(f"Sharpe Ratio: {best_result['sharpe_ratio']:.2f}")
print(f"Total Return: {best_result['total_return']:.2%}")
```

μ΄μ²λΌ QuantBTμ λ³‘λ ¬ μ²λ¦¬ κΈ°λ¥μ„ ν™μ©ν•λ©΄, μ‹κ°„μ΄ λ§μ΄ μ†μ”λλ” νλΌλ―Έν„° μµμ ν™” μ‘μ—…μ„ ν¨μ¨μ μΌλ΅ μν–‰ν•  μ μμµλ‹λ‹¤. λ‹¤μ νν† λ¦¬μ–Όμ—μ„λ” λ” μ§€λ¥μ μΈ μµμ ν™” λ°©λ²•μΈ 'λ² μ΄μ§€μ• μµμ ν™”'μ— λ€ν•΄ μ•μ•„λ³΄κ² μµλ‹λ‹¤. 